---
id: 528
title: More Easily Reconstruct a Transmitted File
date: 2019-03-18T16:22:23+00:00
author: shortmsgserv
layout: post
guid: http://shortmsgserv.co.uk/?p=528
permalink: /more-easily-reconstruct-a-transmitted-file/
image: /wp-content/uploads/2019/03/NetworkMiner_Header.png
categories:
  - NetworkMiner
  - Wireshark
tags:
  - File Reconstruction
  - HTTPS
  - Mono
  - NETRESEC
  - NetworkMiner
  - Packet Capture
  - PCAP
  - PCAPNG
  - Wireshark
---
<div class="wp-block-image">
  <figure class="aligncenter is-resized"><img src="https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/NetworkMiner_Header.png?resize=400%2C300" alt="NetworkMiner Logo on a blue background" class="wp-image-536" width="400" height="300" srcset="https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/NetworkMiner_Header.png?w=800 800w, https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/NetworkMiner_Header.png?resize=300%2C225 300w, https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/NetworkMiner_Header.png?resize=768%2C576 768w" sizes="(max-width: 400px) 100vw, 400px" data-recalc-dims="1" /></figure>
</div>

[Previously](https://shortmsgserv.co.uk/reconstructing-a-transmitted-file/) I have posted a tutorial on how data can be easily reconstructed from a packet capture using Wireshark if the site is using an unsecured connection. This method involves manually reconstructing the desired files by looking for the appropriate signature.

Manually looking for the desired file within a packet capture is a time intensive task and impractical to do in most circumstances. An easier method of finding sensitive information within a packet capture is to use <a rel="noreferrer noopener" aria-label="NetworkMiner by NETRESEC (opens in a new tab)" href="https://www.netresec.com/?page=Networkminer" target="_blank">NetworkMiner by NETRESEC</a>.

NetworkMiner is an application for Windows, but also works on macOS Linux and FreeBSD by using the <a rel="noreferrer noopener" aria-label="Mono  (opens in a new tab)" href="https://www.mono-project.com" target="_blank">Mono</a> framework to run. I followed the <a rel="noreferrer noopener" aria-label="instructions  (opens in a new tab)" href="https://www.netresec.com/?page=Blog&month=2014-06&post=Running-NetworkMiner-on-Mac-OS-X" target="_blank">instructions</a> on the NETRESEC website to install NetworkMiner on my Mac and had the NetworkMiner application up and running within minutes.

You&#8217;ll also need a packet capture file; I attempted to use the same site as I used in my previous blog post, bonsaitreegardener.net, but they have since secured this site. I chose a site from <a rel="noreferrer noopener" aria-label="Why No HTTPS? (opens in a new tab)" href="https://whynohttps.com" target="_blank">Why No HTTPS?</a> to then generate a packet capture file in Wireshark. Surprisingly the website for <a rel="noreferrer noopener" aria-label="Oxford university (opens in a new tab)" href="http://www.ox.ac.uk" target="_blank">Oxford University</a> hasn&#8217;t yet been updated to use HTTPS by default, so I decided to use it for my test of NetworkMiner. When saving the packet capture generated by Wireshark, the format of the packet capture will be Wireshark&#8217;s next generation format (.pcapng), make sure to save the capture as the older version (.pcap) as NetworkMiner is currently unable to read the .pcapng format.

With the packet capture file ready, launch NetworkMiner (on macOS) by going to terminal and using the command 

_$ mono &#8211;arch=32 [NetworkMiner Executable Location.exe]_

NetworkMiner will launch then go to File > Open in the menubar to open your packet capture. It will then be imported into NetworkMiner allowing you to browse the information within.<figure class="wp-block-image is-resized">

<img src="https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/Oxford_University_NetworkMiner_Images_WEB.png?fit=640%2C596&ssl=1" alt="" class="wp-image-532" width="640" height="596" srcset="https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/Oxford_University_NetworkMiner_Images_WEB.png?w=2246 2246w, https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/Oxford_University_NetworkMiner_Images_WEB.png?resize=300%2C279 300w, https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/Oxford_University_NetworkMiner_Images_WEB.png?resize=768%2C715 768w, https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/Oxford_University_NetworkMiner_Images_WEB.png?resize=1024%2C953 1024w, https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/Oxford_University_NetworkMiner_Images_WEB.png?w=1280 1280w, https://i0.wp.com/shortmsgserv.co.uk/wp-content/uploads/2019/03/Oxford_University_NetworkMiner_Images_WEB.png?w=1920 1920w" sizes="(max-width: 640px) 100vw, 640px" /> </figure> 

You&#8217;ll have a range of tabs at the top including the hosts listed within the packet capture as well as any information about them; the images in the packet capture; any credentials as well as the parameters in the capture. 

## Conclusion

Using NetworkMiner is massively quicker than a manual reconstruction of files, I went to around three pages on the Oxford University website and managed to see 47 images, a larger capture could contain thousands more. Any unsecured credentials will easily be shown in the credentials tab, emphasising the need to not broadcast credentials in plaintext and ensure passwords are hashed when authenticating.